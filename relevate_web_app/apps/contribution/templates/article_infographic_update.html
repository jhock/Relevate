{% extends "base-titlebar.html" %}
{% load staticfiles %}
{% block head %}
	{{ block.super }}
	<script type="text/javascript" src="{% static 'js/topic-button.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/infographic-verification.js' %}"></script>
{% endblock %}

{% block content %}
<div class='uk-container uk-margin-top'>
	<form class="uk-form-stacked" enctype='multipart/form-data'
		  action="{% url 'contribution:infographic_update_view' post.slug %}" method="post">{% csrf_token %}
		<h1 class="orange">Update Infographic</h1>
		<div class="uk-panel-box">
			<div class='uk-margin'>
				<label class='uk-form-label uk-text-bold uk-text-lead'>{{ form.title.label }} <span id="title_count"></span></label>
				<div class='uk-form-controls'>
					{{ form.title }}
				</div>
			</div>
			<hr>
			<div class='uk-form-row'>
				<label class='uk-form-label uk-text-bold uk-text-lead'>
					{{ form.blurb.label }} <span id="blurb_count"></span>
				</label>
				<div class='uk-form-controls'>
					{{ form.blurb }}
				</div>
			</div>
			<br>
			<div class='uk-margin'>
				<label class='uk-form-label uk-text-bold uk-text-lead'>{{ form.contents.label }}</label>
				<div class='uk-form-controls'>
					<p>Current: </p>

					<img id="curr_image" src="{{ post.infographic.image.url }}">
					{{ form.contents }}
				</div>
			</div>
			<hr>
			<div hidden>
				{{ form.topic_choices }}
			</div>
			<br>
		</div>
		<br><br>
		<label class='uk-form-label uk-text-bold uk-text-lead'>Infographic Topics</label>
		<p>You must select at least 1 topic for this infographic. Hover over a button to read it's description.</p>
		<div class="uk-card uk-card-default uk-box-shadow-large">
			<div class='uk-card-body'>
				<label class='uk-form-label uk-text-bold'>Selected Topics for Infographics</label>
				<div id="chosen-item-list" uk-grid>
					{% for each_sel in already_sel %}
						{% include 'global-partials/already-selected-topic-partial.html' %}
					{% endfor %}
				</div>
			</div>
		</div>
		<br>
		<div class="uk-card uk-card-default uk-box-shadow-large">
			<div class='uk-card-body'>
				<label class='uk-form-label uk-text-bold'>All Topics</label>
				<div uk-grid>
					{% for topic in tag_names %}
						{% include 'global-partials/available-topics-partial.html' %}
					{% endfor %}
				</div>
			</div>
		</div>
		<br>
		<input id='hidden-publish-checkbox' name='hidden-publish-checkbox' type='checkbox' hidden />
		<div class="uk-grid">
			<div class="uk-width-1-2">
                <button class="submit-button uk-button uk-button-orange" type="button">Update</button>
                <button id='preview-btn' type="button" class="uk-button uk-button-secondary"
                        uk-toggle="target: #preview-modal-info">
                    Preview
                </button>
			</div>
			<a class="uk-button uk-button-danger" href="{% url 'contribution:all_posts' %}">Cancel</a>
		</div>
		<br>
	</form>
    <div id="preview-modal-info" uk-modal>
        <div class="uk-modal-dialog uk-modal-body">
            {% include 'previews/infographic_preview.html' %}
        </div>

    </div>
</div>

{% endblock %}

{% block footer %}
	{{ block.super }}
	<script>
		// Replace the <textarea id="editor1"> with a CKEditor
		// instance, using default configuration.
		CKEDITOR.replace('id_blurb',
		{
			customConfig: '{% static 'js/ckeditor_basic_config.js' %}'
		});
	</script>
{% endblock %}