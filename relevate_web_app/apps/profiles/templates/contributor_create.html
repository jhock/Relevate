{% extends "base-titlebar.html" %}
{% load staticfiles %}

{% block head %}
	{{ block.super }}
	<link rel="stylesheet" type="text/css" href="{% static 'css/contributor-create.css' %}">
	<script type="text/javascript" src="{% static 'js/contributor.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/topic-button.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/degree.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/contributor-create-verification.js' %}"></script>
{% endblock head %}

{% block content %}
<div id="contributorApplication">
	<div class="uk-container uk-margin-top uk-margin-bottom">
		<form id='contributor-create-form' action="{% url 'profile:contributor_create' %}" method="post" enctype='multipart/form-data' class="uk-form uk-form-stacked">
			{% csrf_token %}
			<div class="text-center">
				<h1>Contributor Application</h1>
				<p>All fields marked with an asterisk are required.</p>
				<p>
					Clicking a section header will open up that section for completion. The section
					will be marked as "Done!" when all of the required fields within it are 
					completed.
				</p>
			</div>
			<h4>{{ user.first_name }} {{ user.last_name }}<br>{{ user.email }}</h4>
			<ul uk-accordion>
				<li>
					<h3 class='uk-accordion-title'>
						Degree, Certification, and Affiliation
						<span class='incomplete-span' id='degree-incomplete'>
							<small><span><i>Incomplete</i></span></small>
						</span>
						<span class='done-span' id='degree-done' style='display: none;'>
							<small><span><i>Done!</i></span></small><span uk-icon="icon: check;"></span>
						</span>
					</h3>
					<div class='uk-accordion-content'>
						<div class='uk-card uk-card-default uk-box-shadow-large'>
							<div class='uk-card-body'>
								<div uk-grid>
									<div id='adviser-div' class='uk-width-1-2 uk-hidden'>
										<!-- <h3><label class="blue" for="id_adviser">Mentor<span class="orange">*</span><br></label></h3> -->
										<span>
											If your level of study is Student-Undergraduate or Student-Masters, you will need to select a mentor.
										</span>
										<br>
										<button class='uk-button uk-button-primary' type='button' uk-toggle="target:#adviserListModal;">
											List of Mentors
										</button>
										<br>
										<div class="uk-form-row">
											<label class="uk-form-label uk-text-bold">{{ form.adviser.label }}</label>
											<div class="uk-form-controls">
												{{ form.adviser }}
											</div>
										</div>
										<div id='adviserListModal' class='uk-modal-container' uk-modal>
											<div class="uk-modal-dialog">
												<div class='uk-modal-body'>
													<h1>Mentors</h1>
													<span>
														Identifying and communicating the main points of research articles in a way that is accurate and focused
														takes an understanding of research methods and academic scholarship. In order to promote these skills,
														undergraduate and masters students who apply to be MyRelevate contributors are required to have a mentor.
														MyRelevate mentors are contributors with graduate degrees who value mentoring others (i.e., undergraduate
														and masters students) in becoming educated consumers and communicators of relationship research.
														Check out our impressive mentors below!
													</span>
													<br>
													<br>
													{% if not advisers %}
														<h2 class="uk-text-center">No Mentors at this time.</h2>
													{% else %}
														{% for adviser in advisers %}
														<div id="adviser_profile_{{ adviser.id }}">
															<a  uk-toggle="target: #adviserProfile{{ adviser.id }};">
																<h3 class="blue">
																	{{ adviser.contributor_profile.user_profile.user.first_name }}
																	{{adviser.contributor_profile.user_profile.user.last_name }}
																</h3>
															</a>
														</div>
														<div id="adviserProfile{{ adviser.id }}" class='uk-modal-container' uk-modal>
															<div class='uk-modal-dialog'>
																<div class='uk-modal-body'>
																	{% with contrib_prof=adviser.contributor_profile %}
																		{% include 'partials/contributor_info_display.html' %}
																	{% endwith %}
																</div>
															</div>
														</div>
														{% endfor %}

													{% endif %}
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class='uk-width-1-2'>
									<!-- <h3><label class="blue" for="id_degree">Degree Completed<span class="orange">*</span></label></h3> -->
								</div>
								<p>
									Please enter your most recent degree and click 'Add'. If you have multiple degrees, you may enter the earlier degrees after (e.g., Ph.D. and M.S.)
								</p>
								<input id="hiddenAcaTable" hidden name="academicList">
								<div class='uk-child-width-1-4' uk-grid>
									<div>
										{{ form.program.label }}<span class="orange">*</span>
										<div class="uk-form-controls">
											{{ form.program }}
										</div>
									</div>
									<div>
										{{ form.degree.label }}<span class="orange">*</span>
										<div class="uk-form-controls">
											{{ form.degree }}
										</div>
									</div>
									<div>
										{{ form.institution.label }}<span class="orange">*</span>
										<div id="uni_div">
											<div class="uk-form-row">
												<div class="uk-form-controls">
													{{ form.institution }}
												</div>
											</div>
											<!-- @US_TODO: Fix this so it works with new framework -->
											<div id="list_of_uni" style="width: 500px;" class="uk-dropdown uk-dropdown-search uk-panel-scrollable">
												<ul class="uk-nav uk-nav-search" id="items_to_search">

												</ul>
											</div>
										</div>
									</div>
									<div>
										<br>
										<button id='degree-add-btn' type="button" class="uk-button uk-button-primary" onclick="addAcademicProfile()">Add</button>
									</div>
								</div>
								<table id="acaProf" data-name="acaProfTable" class="uk-table">
									<tbody>
									</tbody>
								</table>
								<!-- <div class="uk-grid-small" uk-grid> -->
								<input id="hiddenCertTable" hidden name="certificateList">
								<!-- <h3><label class="blue">{{ form.certification.label }}</label></h3> -->
								<p>
									If you have any additional certifications, please enter them one at a time by clicking ‘Add’ after you type each one. You may enter as many
									as you currently possess.
								</p>
								<div uk-grid>
									<div class="uk-width-3-4">
										<div class="uk-form-controls">
											{{ form.certification }}
										</div>
									</div>
									<div class='uk-width-1-4'>
										<button type="button" class="uk-button uk-button-primary" onclick="addCertificate()">Add</button>
									</div>
								</div>
								<table id="addCert" data-name="certTable" class="uk-table">
									<tbody>
									</tbody>
								</table>
																<!-- <div class="uk-grid-small" uk-grid> -->
								<input id="hiddenAffilTable" hidden name="affiliationList">
								<!-- <h3><label class="blue">{{ form.certification.label }}</label></h3> -->
								<p>
									Enter a organizational affiliation (if any) and click 'Add'. If you have multiple
									affiliations, you may enter as many as you possess.
								</p>
								<p>
									Double-click on input box for a list of pre-determined organizations, or enter a custom organization.
								</p>
								<div uk-grid>
									<div class="uk-width-3-4">
										<div class="uk-form-controls">
											{{ form.organizational_affiliation }}
										</div>
									</div>
									<div class='uk-width-1-4'>
										<button type="button" class="uk-button uk-button-primary" onclick="addAffiliation()">Add</button>
									</div>
								</div>
								<table id="addAffiliation" data-name="affiliationTable" class="uk-table">
									<tbody>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</li>
				<li>
					<h3 class='uk-accordion-title'>
						Expertise Topics
						<span class='incomplete-span' id='topics-incomplete'>
							<small><span><i>Incomplete</i></span></small>
						</span>
						<span class='done-span' id='topics-done' style='display: none;'>
							<small><span><i>Done!</i></span></small><span uk-icon="icon: check;"></span>
						</span>
					</h3>

					<div class='uk-accordion-content'>
						<!-- <h3  class="blue" >Area of Expertise Relevant to Romantic Relationships<span class="orange">*</span></h3> -->
						<div  class="uk-form-row">
							<label class='uk-form-label uk-text-bold'>
								Area of Expertise Relevant to Romantic Relationships <span class="orange">*</span>
							</label>
							<p>
								Select as many topics as you feel qualified to write about.
							</p>
							<div class='uk-hidden'>
								<div class="uk-form-controls">
									{{ form.area_of_expertise }}
								</div>
							</div>
							<div class="row">
								<div class="uk-card uk-card-default uk-box-shadow-large">
									<div class='uk-card-body'>
										<h3>Selected Topics for Expertise</h3>
										<div id="chosen-item-list" uk-grid>
											{% for each_sel in already_sel %}
												{% include 'global-partials/already-selected-topic-partial.html' %}
											{% endfor %}
										</div>
									</div>
								</div>
							</div>
							<hr>
							<div class="row">
								<div class="uk-card uk-card-default uk-box-shadow-large">
									<div class='uk-card-body'>
										<div>
											<h3>List of Available Topics</h3>
										</div>
										<div uk-grid>
											{% for topic in tag_names %}
												{% include 'global-partials/available-topics-partial.html' %}
											{% endfor %}
										</div>
									</div>
								</div>
							</div>
						</div>

					</div>
				</li>
				<li>
					<h3 class='uk-accordion-title'>
						Professional Information
						<span class='incomplete-span' id='professional-info-incomplete'>
							<small><span><i>Incomplete</i></span></small>
						</span>
						<span class='done-span' id='professional-info-done' style='display: none;'>
							<small><span><i>Done!</i></span></small><span uk-icon="icon: check;"></span>
						</span>
					</h3>
					<div class='uk-accordion-content'>
						<div class='uk-card uk-card-default uk-box-shadow-large'>
							<div class='uk-card-body'>
								<!-- <h3 class="blue" >Professional Information<span class="orange">*</span></h3> -->
								<div class='uk-grid'>
									<div class='uk-width-1-2'>
										<div class="uk-form-row">
											<label class="uk-form-label uk-text-bold">{{ form.address.label }}<span class="orange">*</span></label>
											<div class="uk-form-controls">
												{{ form.address }}
											</div>
										</div>
										<br>
									</div>
									<div class='uk-width-1-2'>
										<div class="uk-form-row">
											<label class="uk-form-label uk-text-bold">{{ form.city.label }}<span class="orange">*</span></label>
											<div class="uk-form-controls">
												{{ form.city }}
											</div>
										</div>
										<br>
									</div>
									<div class='uk-width-1-2'>
										<div class="uk-form-row">
											<label class="uk-form-label uk-text-bold">{{ form.state.label }}<span class="orange">*</span></label>
											<div class="uk-form-controls">
												{{ form.state }}
											</div>
										</div>
										<br>
									</div>
									<div class='uk-width-1-2'>
										<div class="uk-form-row">
											<label class="uk-form-label uk-text-bold">{{ form.country.label }}<span class="orange">*</span></label>
											<div class="uk-form-controls">
												{{ form.country }}
											</div>
										</div>
										<br>
									</div>
									<div class='uk-width-1-2'>
										<div class="uk-form-row">
											<label class="uk-form-label uk-text-bold">{{ form.zipcode.label }}<span class="orange">*</span></label>
											<div class="uk-form-controls">
												{{ form.zipcode }}
											</div>
										</div>
										<br>
									</div>
								</div>
								<div class="uk-form-row">
									<label class="uk-form-label uk-text-bold">{{ form.website_url.label }}</label>
									<div class="uk-form-controls">
										{{ form.website_url }}
									</div>
								</div>
								<br>
								<div class='uk-grid'>
									<div class='uk-width-1-2'>
										<!-- <h3 class="blue" >Upload your cv/resume</h3> -->
										<div class="uk-form-row">
											<label class="uk-form-label uk-text-bold">{{ form.cv.label }}</label>
											<div class="uk-form-controls">
												{{ form.cv }}
											</div>
										</div>
									</div>
									<div class='uk-width-1-2'>
										<!-- <h3 class="blue">Profile Picture</h3> -->
										<div class="uk-form-row">
											<label class="uk-form-label uk-text-bold">{{ form.avatar.label }}</label>
											<div class="uk-form-controls">
												{{ form.avatar }}


		<div class="uk-hidden">
			{{ form.x }}
			{{ form.y }}
			{{ form.height }}
			{{ form.width }}
		</div>

		  <!-- MODAL TO CROP THE IMAGE -->
		  <div class="modal fade" id="modalCrop">
			<div class="modal-dialog">
			  <div class="modal-content">
				<div class="modal-header">
				  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				  </button>
				  <h4 class="modal-title">Crop the photo</h4>
				</div>
				<div class="modal-body">
				  <img src="" id="image" style="max-width: 100%;">
				</div>
				<div class="modal-footer">
				  <div class="btn-group pull-left" role="group">
					<button type="button" class="btn btn-default js-zoom-in">
					  <span class="glyphicon glyphicon-zoom-in"></span>
					</button>
					<button type="button" class="btn btn-default js-zoom-out">
					  <span class="glyphicon glyphicon-zoom-out"></span>
					</button>
				  </div>
				  <button type="button" class="btn btn-default" data-dismiss="modal">Nevermind</button>
				  <button type="button" class="btn btn-primary js-crop-and-upload">Crop and upload</button>
				</div>
			  </div>
			</div>
		  </div>

		  <!-- CONTAINER TO DISPLAY THE CROPPED IMAGES -->
		  <div class="row uk-hidden" style="margin-top: 20px">
			  <div class="col-sm-4 col-md-3" id="cropped_thumbnail">
				<img src="{{ form.avatar.url }}" class="thumbnail">
			  </div>
		  </div>

											</div>
										</div>
									</div>
								</div>
								<!-- <h3 class="blue" >Professional Interests, Experience, and Expertise<span class="orange">*</span></h3> -->
								<br><br>
								<div class="uk-form-row">
									<label class='uk-form-label uk-text-bold'>
										{{ form.biography.label }} <span class="orange">*</span>
									</label>
									<div>
										Please provide a brief background about who you are! What are your special interests?
										Why do you want to be a contributor for Relevate? Are there any other things you want
										readers to know about you? If approved, this biography will go on your contributor
										profile page, so be sure to write it thought you are speaking directly to the users
										of Relevate who may explore and view your profile. This means avoiding jargon and
										acronyms, and writing at a lower reading level.
									</div>
									<br>
									<div class="uk-form-controls">
										{{ form.biography }}
									</div>
								</div>
							</div>
						</div>
					</div>
				</li>
				<li>
					<h3 class='uk-accordion-title'>
						Terms And Conditions
						<span class='incomplete-span' id='terms-incomplete'>
							<small><span><i>Incomplete</i></span></small>
						</span>
						<span class='done-span' style='display:none;' id='terms-done'>
							<small><span><i>Done!</i></span></small><span uk-icon="icon: check;"></span>
						</span>
					</h3>
					<div class='uk-accordion-content'>
						<div class='uk-card uk-card-default uk-box-shadow-large'>
							<div class='uk-card-body'>
								<!-- <h3 class="blue" >Terms and Conditions<span class="orange">*</span></h3> -->
								<div class="uk-panel-scrollable" style='background-color: white;'>
									<span>
										Any information on any topic given by Relevate, its members, its contributors,
										and/or its community members should not be considered to be advice, diagnosis,
										and/or any treatment appropriate for its readers. Appropriate advice, diagnosis,
										and/or treatment can only be given by licensed professionals within a professional
										setting. Relevate makes no claim to be a professional setting appropriate for
										giving advice, diagnosis, and/or treatment. Although many contributors to Relevate
										topics are licensed professionals, the information shared by Relevate, its members,
										its contributors, and its community members is subject to error and should not be
										used to make any major life choices. The purpose of Relevate is to share general
										research findings, which is subject to error and may not apply to each reader.
										Relevate information may contain a call to action, which is subject to error and
										may not apply to each reader. The reader assumes all risks of making decisions and
										choices based on information that he/she found on Relevate's website, app, social
										media pages, or any other source of Relevate information. The reader withdraws any
										right to civil or legal claims or litigation of any type against Relevate, its
										members, and its contributors due to any consequences of choices made by the reader
										based on information gained through Relevate or any of its parties.
									</span>
									<br><br><br>
									<span>
										Relevate reserves the right to remove any information that it believes to be contrary to its
										purpose or inappropriate in nature. Examples of material subject to removal include but are not
										limited to any material that is inflammatory, illegal, commercial in nature, off topic,
										discriminatory, dangerous, plagiarized material, personally identifiable information, and any
										other material Relevate decides to remove. Relevate reserves the right to remove any
										contributor or community member and any material added from any contributor or community member
										from its database including but not limited to screen name, comments, contributions, ratings,
										and any other material.
									</span>
								</div>
								<p>I agree to terms and conditions<span class="orange">*</span>: {{ form.accept_terms }}</p>
							</div>
						</div>
					</div>
				</li>
			</ul>
			<!-- </div> -->
		</form>
		<br/>
		<button id="submit-btn" type='button' class='uk-button uk-button-primary'>Submit</button>
	</div>
</div>

{% endblock %}

{% block footer %}
	{{ block.super }}
	<script>

        var verificationFlags;
        var mentorNeeded = false;
        $(document).ready(function () {
            universitySearchUrl = "{% url 'profile:query_universities' %}";
            academicId = parseInt("{{ max_academic_id }}") + 2;
            certId = parseInt('{{ max_certification_id }}') + 2;
            affiliationId = parseInt('{{ max_affiliation_id }}') + 2;
            academicTable = [];
            certificationTable = [];
            affiliationTable = [];
            updateTablesUpdateInfo(true);
            updateTablesUpdateInfo(false);
        });
	</script>
{% endblock %}

